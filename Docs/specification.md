## 📚명세서

### 📌요구사항 명세서

#### 기능적 요구사항

| 순번  | 요구사항명     | 요구사항 상세                                                                                                                                                                                                      | 우선순위  |
| ----- | -------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | --------- |
| F01_1 | 회원가입       | 1. 이메일, 비밀번호, 닉네임을 입력받고 회원 가입 가능<br>2. Google 계정으로 회원가입                                                                                                                               | 매우 높음 |
| F01_2 | 회원정보 수정  | 기존 비밀번호를 입력하고 이후 새로운 비밀번호 등록하여 비밀번호 수정                                                                                                                                               | 보통      |
| F01_3 | 회원정보 조회  | 닉네임, ID, Email을 확인 가능한 프로필 페이지 보여주기                                                                                                                                                             | 높음      |
| F01_4 | 회원 탈퇴      | 유저 개인 정보만 삭제 후 탈퇴 처리                                                                                                                                                                                 | 높음      |
| F01_5 | 로그인         | - email, password 로 로그인<br>- Google 계정으로 로그인                                                                                                                                                            | 매우 높음 |
| F01_6 | 로그아웃       | token 삭제하여 로그아웃                                                                                                                                                                                            | 매우 높음 |
| F01_7 | 비밀번호 찾기  | Email 인증으로 비밀번호 찾기                                                                                                                                                                                       | 보통      |
| F02   | 회원 전적 확인 | - 본인의 최근 전적 10개 확인<br>- 플레이한 직업, 승패를 색깔로 표시<br>- 참가한 인원수와 직업 대표 이미지 표시                                                                                                     | 높음      |
| F03   | 방 관리        | 1. 방을 100개까지 유지<br>2. 방 존재 여부 및 참가 인원 조회<br>3. 방 인원수 설정, 게임 타이머 설정<br>4. 8명 이하의 화상 및 채팅이 가능한 방 생성<br>5. 게임 준비 상태에서만 게임 시작<br>6. 방장이 방을 삭제 가능 | 매우 높음 |
| F04   | 투표 기능      | 밤이 되면 유저 중 한 명을 선택                                                                                                                                                                                     | 매우 높음 |
| F05   | 게임 기능      | 1. 밤과 낮을 번갈아가며 턴제 기반의 게임 구현<br>2. 랜덤으로 역할 배정<br>3. 역할에 따라 능력 사용 가능<br>4. 상황에 따라 유저의 카메라 및 소리 설정 변경 가능                                                     | 매우 높음 |
| F06   | 도움말 기능    | 게임룰 및 직업 설명 확인                                                                                                                                                                                           | 보통      |
| F07   | 채팅 기능      | 유저들 간의 텍스트 기반 통신 가능                                                                                                                                                                                  | 높음      |
| F08   | 사운드         | - 프로그램 실행 시 초기화면에 배경 음악 재생<br>- 상황에 맞는 효과음 적용                                                                                                                                          | 매우 높음 |
| F09   | 디자인         | 토끼 이미지: 기본, 걷기, 눕기(죽음), 처형 이미지                                                                                                                                                                   | 매우 높음 |
| F10   | 예외 사항 처리 | 통신 불안정 혹은 유저가 중간에 나갔을 경우 다시 접속하도록 처리                                                                                                                                                    | 높음      |

#### 비기능적 요구사항

| 순번 | 요구사항명    | 요구사항 상세                                      | 우선순위 |
| ---- | ------------- | -------------------------------------------------- | -------- |
| NF1  | 사용자 편의성 | 웹 사이트에 대한 사전지식이 없어도 쓰기 편해야 함  |          |
| NF2  | 실시간 통신   | 1. 8명 이하의 동시 화상 통신 및 채팅이 가능해야 함 |          |
|      |               | 2. 영상 통신 딜레이가 100ms 이하여야 함            |          |
|      |               | 3. 채팅 딜레이가 50ms 이하여야 함                  |          |
| NF3  | 응답성        | 방 리스트 조회에 걸리는 시간이 2초 이하여야 함     |          |
|      |               | 방 입장 시 걸리는 시간이 3초 이하                  |          |
|      |               | 방 생성 시 걸리는 시간이 3초 이하                  |          |
| NF4  | 호환성        | DeskTop PC 및 크롬 브라우저 권장                   |          |
|      |               | 화면 해상도 1920*1080 or 1536*846에 최적화         |          |

### 📌기능 명세서

| 대분류        | 소분류                | 주기능                          | 상세기능                                                                                                                                                                                   | 우선순위  | 페이지           |
| ------------- | --------------------- | ------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | --------- | ---------------- | --- |
| 1. 회원 관리  | 1.1 회원 가입         | 1.1.1 이메일 입력               | @을 포함한 이메일 형식                                                                                                                                                                     | 매우 높음 | 회원 가입 페이지 |
|               |                       |                                 | 확인                                                                                                                                                                                       |           |                  |
|               | 1.2 로그인            | 1.2.1 이메일 입력               | 입력 받은 이메일 존재 확인                                                                                                                                                                 | 매우 높음 | 메인 홈 화면     |
|               |                       |                                 | (유저 정보 제공 X)                                                                                                                                                                         |           |                  |
|               | 1.3 비밀번호 찾기     | 1.3.1 이메일 입력 및 확인       | 가입시 Email 유저 확인                                                                                                                                                                     | 매우 높음 | PW 찾기 페이지   |
| 2. 마이페이지 | 2.1 회원 정보 수정    | 2.1.1 닉네임 변경               | 현재 닉네임 확인 후 업데이트                                                                                                                                                               | 높음      | 마이 페이지      |
|               | 2.2 회원 탈퇴         | 2.2.1 회원 탈퇴 처리            | db user.idDeleted → 1                                                                                                                                                                      | 매우 높음 | 마이 페이지      |
|               | 2.3 회원 정보 조회    | 2.3.1 닉네임, 이메일 조회       | 진입 시 백으로 요청                                                                                                                                                                        | 높음      | 마이 페이지      |
|               | 2.4 게임 전적 조회    | 2.4.1 이전 플레이 기록 조회     | 이전 플레이 기록 전송<br>페이지 마다 5개씩 표시<br>승패 여부, 내 역할, 날짜,<br>플레이 시간                                                                                                | 보통      | 마이 페이지      |     |
|               | 2.5 게임 전적 통계    | 2.5.1 유저 전적 통계 표시       | 백에서 계산한 데이터 전송<br>총 플레이 수, 총 승률,<br>역할 별 플레이 수, 역할 별<br>승률, 역할 별 능력 발동 횟수                                                                          | 낮음      | 마이 페이지      |
|               | 2.6 로그아웃          | 2.6.1 로그아웃                  | access token과 refresh tokken<br>삭제하여 로그아웃 처리                                                                                                                                    | 매우 높음 | 마이 페이지      |
| 3. 방 관리    | 3.1 방 만들기         | 3.1.1 방 제목 입력              | 16자 이하의 문자열 <br> 프론트에서 검증                                                                                                                                                    | 매우 높음 | 방 입장 전 로비  |
|               | 3.2 방 리스트 조회    | 3.2.1 현재 생성된 방 조회       | 모든 session 정보 요청<br> 현재 생성된 session 전달                                                                                                                                        | 매우 높음 | 방 입장 전 로비  |
|               | 3.3 방 정보 수정      | 3.3.1 사용 역할 설정            | 게임에서 제외할 역할 선택                                                                                                                                                                  | 낮음      | 게임 대기실      |
|               | 3.4 방 삭제           | 3.4.1 방 삭제                   | 방장이 나갔을 때 방 삭제                                                                                                                                                                   | 매우 높음 | 게임 대기실      |
|               | 3.5 게임 시작         | 3.5.1 방장이 게임 시작          | 게임 시작 및 직업 배정 요청                                                                                                                                                                | 매우 높음 | 게임 대기실      |
|               | 3.6 방 준비           | 3.6.1 방장 이외 인원 레디       |                                                                                                                                                                                            | 낮음      | 게임 대기실      |
|               | 3.7 방 빠른 입장      | 3.7.1 남는 방에 랜덤으로 입장   |                                                                                                                                                                                            | 매우 낮음 | 방 입장 전 로비  |
|               | 3.8 채팅 기능         | 3.8.1 대기실 인원끼리 채팅 가능 | 각 인원의 색상으로 채팅 <br>글자 색상 표시                                                                                                                                                 | 매우 높음 | 게임 대기실      |
|               | 3.9 도움말 기능       | 3.8.1 게임 룰 및 역할 설명      | 도움말 버튼 누르면 <br>설명창 표시                                                                                                                                                         | 낮음      | 게임 대기실      |
| 4. 게임       | 4.1 게임 입장 시 기능 | 4.1.1 유저 카메라 연결 확인     | 프론트에서 해결                                                                                                                                                                            | 높음      | 게임 진행 중     |
|               | 4.2 게임 진행 중 기능 | 4.2.1 영상 On/Off 기능(유저)    | 유저 임의로 영상 끄기                                                                                                                                                                      | 매우 높음 | 게임 진행 중     |
|               | 4.3 턴 기능           | 4.3.1 토론 턴                   | 타이머 90초 <br> 모든 유저 카메라/마이크/스피커 On                                                                                                                                         |           |                  |
|               |                       | 4.3.2 투표 턴                   | 타이머 15초 <br>유저 투표 가능 <br>모든 유저 카메라/마이크/스피커 On                                                                                                                       | 높음      | 게임 진행 중     |
|               |                       | 4.3.3 낮 → 밤 전환 턴           | 타이머 5초 <br>투표당한 유저 카메라/마이크/스피커 On<br>나머지 유저 모두 카메라/마이크/스피커 Off<ㅠㄱ>유저 처형 및 유령 생성 <br>처형 애니메이션 재생<br>처형 결과 및 능력 사용 결과 표시 | 매우 높음 | 게임 진행 중     |
|               |                       | 4.3.4 밤 턴                     | 타이머 60초<br>모든 유저 카메라 Off<br>자라만 마이크/스피커 On<br>나머지는 모두 Off<br>능력 사용할 수 있는 유저만 능력 사용                                                                | 매우 높음 | 게임 진행 중     |
|               |                       | 4.3.5 밤 → 낮 전환 턴           | 자라에게 살해된 유저 유령 생성<br>살해 애니메이션 재생<br>살해 결과 표시 후 능력 사용 결과 표시                                                                                            | 높음      | 게임 진행 중     |

### 📌API 명세서

#### HTTPS

| 대분류                                                                                                              | 주기능                                                                                            | Mapping                      | Data                                                                                                                                                                                                                                                                                                                    | Return                                                                                                             | 설명                                                                                                                                       |
| ------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------- | ---------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------ | --- |
| User                                                                                                                | 이메일 중복 검사, 인증번호 전송                                                                   | POST /users/email/confirm    | ?email=email@email.com                                                                                                                                                                                                                                                                                                  | 200 - 사용 가능<br>409 - 이메일 중복<br>422 - 이메일 형식 오류<br>429 - 재전송 대기 시간<br>502 - 이메일 전송 실패 | 이메일 형식 확인<br>이메일 중복 검사<br>인증번호 이메일 전송                                                                               |
|                                                                                                                     | 이후 이메일로 인증번호 전송                                                                       | POST /users/join             | {<br>&nbsp;&nbsp;email: string,<br>&nbsp;&nbsp;password: string,<br>&nbsp;&nbsp;nickname: string,<br>&nbsp;&nbsp;emailVerificationCode: string<br>}                                                                                                                                                                     |
| 201 - 회원가입 성공<br>400 - 이메일 인증 실패<br>409 - 중복된 이메일<br>422 - 이메일, 비밀번호, 닉네임 중 형식 오류 | 이메일 형식 확인<br>닉네임 형식 확인(10자 이하)<br>비밀번호 형식 확인(영어, 숫자 조합 6자리 이상) |
|                                                                                                                     | 이메일 인증번호 전송 필                                                                           | POST /users/email            | ?email=email@email.com                                                                                                                                                                                                                                                                                                  | 200 - 이메일 전송 성공<br>404 - 사용자를 찾을 수 없습니다<br>429 - 재전송 대기시간<br>502 - 이메일 전송 실패       | 영어 대/소문자, 숫자로 이루어진 8자리 인증번호 전송<br>전송 후 1분 동안 같은 이메일로 재전송 불가<br>인증번호는 전송 후 5분 동안 사용 가능 |
|                                                                                                                     | 비밀번호 초기화                                                                                   | POST /users/reset-password   | {<br>&nbsp;&nbsp;email: string,<br>&nbsp;&nbsp;password: string,<br>&nbsp;&nbsp;emailVerificationCode: string<br>}                                                                                                                                                                                                      | 200 - 초기화 성공<br>400 - 이메일 인증 실패<br>422 - 이메일, 비밀번호 형식 오류                                    | Email로 emailVerificationCode 발송하고 코드와 변경할 비밀번호 입력                                                                         |
|                                                                                                                     | 비밀번호 수정(프로필? 어디에?)                                                                    | PATCH /users/change-password | {<br>&nbsp;&nbsp;password: string,<br>&nbsp;&nbsp;newPassword: string<br>}                                                                                                                                                                                                                                              | 200 - 변경 성공<br>401 - 기존 비밀번호 오류<br>401 - 토큰 오류<br>404 - 사용자를 찾을 수 없습니다                  | 현재 비밀번호 확인<br>새로운 비밀번호 형식 확인<br>비밀번호 변경                                                                           |
|                                                                                                                     | 닉네임 수정                                                                                       | PATCH /users/change-nickname | {<br>&nbsp;&nbsp;nickname: string<br>}                                                                                                                                                                                                                                                                                  |                                                                                                                    | 닉네임 수정                                                                                                                                |
|                                                                                                                     | 회원탈퇴(프로필? 어디에?)                                                                         | DELETE /users                | {<br>&nbsp;&nbsp;password: string<br>}                                                                                                                                                                                                                                                                                  | 200 - 수정 성공<br>401 - 비밀번호 오류<br>401 - 토큰 오류<br>404 - 사용자를 찾을 수 없습니다                       | 비밀번호 확인<br>db user.idDeleted → 1<br>이메일, 비밀번호 삭제 처리<br>닉네임 → “탈퇴한 유저”<br>로그아웃 처리                            |
|                                                                                                                     | 내 정보                                                                                           | GET /users/me                |                                                                                                                                                                                                                                                                                                                         | 200 - 조회 성공<br>401 - 토큰 오류<br>404 - 사용자를 찾을 수 없습니다                                              | 로그인된 사용자의 정보 조회                                                                                                                |
|                                                                                                                     | 토큰 재발급                                                                                       | POST /users/refresh-token    | Cookie(refreshToken)                                                                                                                                                                                                                                                                                                    | 200 - 토큰 재발급 성공<br>401 - 토큰이 유효하지 않음<br>404 - 사용자를 찾을 수 없음                                |                                                                                                                                            |
| rooms                                                                                                               | 소켓 연결시                                                                                       |                              |                                                                                                                                                                                                                                                                                                                         |                                                                                                                    |                                                                                                                                            |     |
|                                                                                                                     | 방 만들기                                                                                         | POST                         | {<br>&nbsp;&nbsp;roomCode: string<br>}                                                                                                                                                                                                                                                                                  | 200 - 방 만들기 성공<br>401 - 토큰이 유효하지 않음<br>404 - 사용자를 찾을 수 없음                                  | 방 생성 시 초기 인원은 0으로 설정                                                                                                          |
|                                                                                                                     | 방 찾기(리스트 조회)                                                                              | GET                          |                                                                                                                                                                                                                                                                                                                         | 200 - 방 리스트 조회 성공<br>List<Room>                                                                            |                                                                                                                                            |
|                                                                                                                     | 방 삭제                                                                                           | DELETE                       | /{roomCode}                                                                                                                                                                                                                                                                                                             |                                                                                                                    | 받은 accessToken과 roomCode를 사용하여 해당 방의 owner가 맞으면 성공 아니면 거부                                                           |
|                                                                                                                     | 방 입장가능 조회                                                                                  | GET                          | /{roomCode}                                                                                                                                                                                                                                                                                                             | 200 - 입장 가능<br>404 - roomCode가 유효하지 않음<br>403 - 인원 수 초과                                            |                                                                                                                                            |
| point                                                                                                               | 포인트 조회                                                                                       | GET /point                   |                                                                                                                                                                                                                                                                                                                         | 200 - 포인트 조회 성공<br>{ "int" }                                                                                |                                                                                                                                            |
|                                                                                                                     | 게임에서 얻은 포인트 조회                                                                         | GET /point/{gameCode}        | {<br>&nbsp;&nbsp;lastPoint: 0,<br>&nbsp;&nbsp;currentPoint: 0<br>}                                                                                                                                                                                                                                                      | 200 - 포인트 조회 성공<br>404 - User Not Found<br>404 - Game Not Found                                             |                                                                                                                                            |
| shop                                                                                                                | 아이템 목록 조회                                                                                  | GET /shop/{itemType}         | {<br>&nbsp;&nbsp;itemSeq: 0,<br>&nbsp;&nbsp;price: 0,<br>&nbsp;&nbsp;image: "string",<br>&nbsp;&nbsp;sold: true<br>}                                                                                                                                                                                                    | 200 - 조회 성공                                                                                                    | sold - true → 구매한 물품                                                                                                                  |
|                                                                                                                     | 아이템 구매                                                                                       | POST /shop/buy               | {<br>&nbsp;&nbsp;items: [<br>&nbsp;&nbsp;&nbsp;&nbsp;itemSeq<br>&nbsp;&nbsp;&nbsp;&nbsp;...<br>&nbsp;&nbsp;]<br>}                                                                                                                                                                                                       | 200 - 구매 성공<br>403 - Insufficient Point<br>403 - Already Purchased<br>404 - 유저를 찾을 수 없습니다            |
|                                                                                                                     | 아이템 장착                                                                                       | PATCH /shop/equipped         | {<br>&nbsp;&nbsp;items: [<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;itemSeq: 0,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;price: 0,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;image: "string",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sold: true<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;]<br>} | 200 - 아이템 장착 성공<br>401 - 보유하지 않은 아이템<br>404 - 유저를 찾을 수 없습니다.                             | 장착할 아이템 전부 보내줘야 함 (type 중복되지 않게)                                                                                        |
| record                                                                                                              | 전체 승률                                                                                         | GET /record/winRate          |                                                                                                                                                                                                                                                                                                                         | 200 - 조회 성공<br>100<br>404 - 유저 정보가 존재하지 않습니다.                                                     |                                                                                                                                            |
|                                                                                                                     | 최근 10개 기록                                                                                    | GET /record/recent           | [<br>&nbsp;&nbsp;{<br>&nbsp;&nbsp;jobSeq: 3,<br>&nbsp;&nbsp;roomSeq: 7,<br>&nbsp;&nbsp;playAt: 2023-08-03T09:02:06,<br>&nbsp;&nbsp;endAt: 2023-08-03T10:02:06,<br>&nbsp;&nbsp;win: true<br>&nbsp;&nbsp;},<br>&nbsp;&nbsp;...<br>]                                                                                       | 200 - 조회 성공<br>404 - 유저 정보가 존재하지 않습니다                                                             |                                                                                                                                            |
|                                                                                                                     | 직업별 승률                                                                                       | GET /record/jobWinRate       | [0, 50, 100, 0, 100]                                                                                                                                                                                                                                                                                                    | 200 - 조회 성공<br>404 - 유저 정보가 존재하지 않습니다.                                                            |                                                                                                                                            |
| level                                                                                                               | 유저 레벨 정보                                                                                    | GET /level                   | {<br>&nbsp;&nbsp;level: 1,<br>&nbsp;&nbsp;exp: 0,<br>&nbsp;&nbsp;maxExp: 0<br>}                                                                                                                                                                                                                                         | 200 - 조회 성공                                                                                                    |                                                                                                                                            |
|                                                                                                                     | 게임에서 얻은 경험치 정보                                                                         | GET /level/{gameCode}        | {<br>&nbsp;&nbsp;lastExp: 0,<br>&nbsp;&nbsp;currentExp: 0,<br>&nbsp;&nbsp;maxExp: 0,<br>&nbsp;&nbsp;lastLevel: 0,<br>&nbsp;&nbsp;currentLevel: 0<br>}                                                                                                                                                                   | 200 - 조회 성공<br>404 - User Not Found<br>404 - Game Not Found                                                    |                                                                                                                                            |

#### WSS

**subscribe room**
| destination | action | data | 설명 |
|--------------------------------|---------------------------|-----------------------------------------------------------------------------------------------------------------------|------------------------------------------------------|
| /sub/room/${roomCode} | 방 세팅, 입장 | type: ROOM_ENTER_SETTING<br>roomCode: string<br>data: {<br>roomCode: string<br>title: string<br>...<br>} | 어떤 인원이 방입장시 해당 방을 구독한 모든 인원에게 모든 방 정보 뿌리기 |
| | 채팅 | type: ROOM_CHAT<br>roomCode: string<br>data: {<br>nickname: string<br>message: string<br>} | |
| | 퇴장 | type: ROOM_EXIT<br>roomCode: string<br>data: string | |
| | 방 세팅 | type: ROOM_TITLE<br>roomCode: string<br>data: string | 방장이 수정하여 pub 한 데이터에 type 추가하여 전달 |
| | 방 세팅 | type: ROOM_START<br>roomCode: string<br>data: string; | 방장이 게임을 시작한 경우, type 추가하여 pub 전달 |
| | 방 세팅 | type: ROOM_JOB_SETTING<br>roomCode: string<br>data: {<br>"1": boolean,<br>"2": boolean,<br>...<br>"7": boolean<br>} | 방장이 수정하여 pub 한 데이터 type 추가하여 전달 |
| | 방 세팅 | type: ROOM_CHANGE_OWNER<br>roomCode: string<br>data: number(ownerSeq) | 방장이 unsubscribe 한 경우<br>방 폭파시, -1 |
| | 게임 레디, 방 세팅 | type: ROOM_CUR_SEATS<br>roomCode: string<br>data: CureSeats | 방 인원이 퇴장 메세지를 pub 하면 남은 인원들에게 수정된 CUR_SEATS 전송 |
| | 방에서 복귀 | type: ROOM_COMEBACK_SETTING<br>roomCode: string<br>data : {<br>title: string<br>...<br>data: CureSeats<br>} | |

**publish room**
| destination | action | data | 설명 |
|--------------------------------------|---------------|----------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------|
| /pub/room/${roomCode}/enter          | 입장          | 토큰 추가                                                                                                                                                 |                                |
| /pub/room/${roomCode}/chat | 채팅 | {<br>senderSeq: userSeq;<br>message: string<br>} | |
| /pub/room/${roomCode}/exit            | 퇴장          | 토큰 추가                                                                                                                                                 |                                |
| /pub/room/${roomCode}/title | 방 세팅 | {<br>title: string<br>} | 방 인원 모두에게 방 정보 전송 |
| /pub/room/${roomCode}/jobSetting      | 방 세팅       | {<br>jobSetting: {<br>"1": boolean,<br>"2": boolean,<br>...<br>"7": boolean<br>}             |                                |
| /pub/room/${roomCode}/start | 방 세팅 | | |
| /pub/room/${roomCode}/curSeats        | 게임 레디,방 세팅 | {<br>curSeats: CureSeats<br>} |                                |
| /pub/room/${roomCode}/comeBack | 방에서 복귀 | 토큰 추가 | |

**subscribe game**
| destination | action | data | 설명 |
|---------------------------------|-----------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------|
| /sub/game/${gameCode}/all       | 게임 시작             | {<br>&nbsp;&nbsp;type: GAME_START,<br>&nbsp;&nbsp;gameCode: string,<br>&nbsp;&nbsp;data: [<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;userSeq: 0,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jobSeq: 3,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nickname: string,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;equippedItems: {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;face: string,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cap: string,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clothing: string<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;equippedItemsGif: {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;face: string,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cap: string,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clothing: string<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;},<br>&nbsp;&nbsp;&nbsp;&nbsp;....<br>&nbsp;&nbsp;]<br>} | 해당 게임의 모든 유저가 구독하는 destination |
|                                 | 채팅                  | {<br>&nbsp;&nbsp;type: CHAT_ALL,<br>&nbsp;&nbsp;gameCode: string,<br>&nbsp;&nbsp;data: {<br>&nbsp;&nbsp;&nbsp;&nbsp;sender: number,<br>&nbsp;&nbsp;&nbsp;&nbsp;nickname: string,<br>&nbsp;&nbsp;&nbsp;&nbsp;message: string<br>&nbsp;&nbsp;}<br>}                                      |                                            |
|                                 | 투표 중               | {<br>&nbsp;&nbsp;type: GAME_VOTE;<br>&nbsp;&nbsp;gameCode: string;<br>&nbsp;&nbsp;data: [<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;userSeq: userSeq;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnt: number;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;]<br>} | userSeq 0번이면 무효표             |
|                                 | 투표 결과             | {<br>&nbsp;&nbsp;type: GAME_VOTE_RESULT;<br>&nbsp;&nbsp;gameCode: string;<br>&nbsp;&nbsp;data: {<br>&nbsp;&nbsp;&nbsp;&nbsp;userSeq: number,<br>&nbsp;&nbsp;&nbsp;&nbsp;politicianSeq: number<br>&nbsp;&nbsp;}<br>}|                                    |
|                                 | 타이머                | {<br>&nbsp;&nbsp;type: GAME_TIMER;<br>&nbsp;&nbsp;gameCode: string;<br>&nbsp;&nbsp;data: {<br>&nbsp;&nbsp;&nbsp;&nbsp;type: string,<br>&nbsp;&nbsp;&nbsp;&nbsp;time: int<br>&nbsp;&nbsp;}<br>}| 타이머 시작 공지<br>type: NONE, DAY, VOTE, NIGHT |
|                                 | 타이머 감소           | {<br>&nbsp;&nbsp;type: "GAME_TIMER_DECREASE",<br>&nbsp;&nbsp;code: string,<br>&nbsp;&nbsp;data: decreaseTime<br>}| 타이머 감소(10초)<br>userSeq별 한번씩만 가능 |
|                                 | 밤 시간 이후 생존 여부 | {<br>&nbsp;&nbsp;type: GAME_NIGHT_RESULT,<br>&nbsp;&nbsp;gameCode: string,<br>&nbsp;&nbsp;data: {<br>&nbsp;&nbsp;&nbsp;&nbsp;userSeq: number,<br>&nbsp;&nbsp;&nbsp;&nbsp;ability: [<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{userSeq: boolean},<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br>&nbsp;&nbsp;&nbsp;&nbsp;]<br>&nbsp;&nbsp;}<br>}| |
|                                 | 최종 게임 결과         | {<br>&nbsp;&nbsp;"type": "GAME_OVER",<br>&nbsp;&nbsp;"code": string,<br>&nbsp;&nbsp;"data": {<br>&nbsp;&nbsp;&nbsp;&nbsp;"rabbitWin": boolean,<br>&nbsp;&nbsp;&nbsp;&nbsp;"userInfo": [<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"userSeq": number,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"jobSeq": number,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"win": boolean,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"nickname": string,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},<br>&nbsp;&nbsp;&nbsp;&nbsp;]<br>&nbsp;&nbsp;}<br>}|                                    |
|                                 | 캐릭터 위치            | {<br>&nbsp;&nbsp;"type": "GAME_CHAR_LOC",<br>&nbsp;&nbsp;"gameCode": number,<br>&nbsp;&nbsp;"data": {<br>&nbsp;&nbsp;&nbsp;&nbsp;"orderNo": 0,<br>&nbsp;&nbsp;&nbsp;&nbsp;"xAxis": Double,<br>&nbsp;&nbsp;&nbsp;&nbsp;"yAxis": Double<br>&nbsp;&nbsp;}<br>} | 우선순위 낮음                        |
|                                 | 화면 가리기            | {<br>&nbsp;&nbsp;"type": "GAME_BLACKOUT",<br>&nbsp;&nbsp;"code": "String",<br>&nbsp;&nbsp;"data": {<br>&nbsp;&nbsp;&nbsp;&nbsp;"userSeq": number,<br>&nbsp;&nbsp;&nbsp;&nbsp;"startSecond": number<br>&nbsp;&nbsp;}<br>}| 낮일때 userSeq 유저에게 startSecond 부터 암막 효과 부여 |
| /sub/game/${gameCode}/zara | 채팅 | {<br>&nbsp;&nbsp;"type": "CHAT_ZARA",<br>&nbsp;&nbsp;"gameCode": number,<br>&nbsp;&nbsp;"data": {<br>&nbsp;&nbsp;&nbsp;&nbsp;"sender": "userSeq",<br>&nbsp;&nbsp;&nbsp;&nbsp;"nickname": "string",<br>&nbsp;&nbsp;&nbsp;&nbsp;"message": "string"<br>&nbsp;&nbsp;}<br>} | |
| | 능력 사용 | {<br>&nbsp;&nbsp;"type": "ABILITY",<br>&nbsp;&nbsp;"gameCode": number,<br>&nbsp;&nbsp;"targetUserSeq": 2<br>}| |
| /sub/game/${gameCode}/ghost | 채팅 | {<br>&nbsp;&nbsp;"type": "CHAT_GHOST",<br>&nbsp;&nbsp;"gameCode": number,<br>&nbsp;&nbsp;"data": {<br>&nbsp;&nbsp;&nbsp;&nbsp;"sender": userSeq,<br>&nbsp;&nbsp;&nbsp;&nbsp;"nickname": string,<br>&nbsp;&nbsp;&nbsp;&nbsp;"message": string<br>&nbsp;&nbsp;}<br>}| |
| | 능력 사용 | {<br>&nbsp;&nbsp;"type": "ABILITY_GHOST",<br>&nbsp;&nbsp;"code": string,<br>&nbsp;&nbsp;"data": {<br>&nbsp;&nbsp;&nbsp;&nbsp;"userSeq": number,<br>&nbsp;&nbsp;&nbsp;&nbsp;"targetUserSeq": number<br>&nbsp;&nbsp;}<br>}| |

**publish game**
| destination | action | data | 설명 |
|-----------------------------------------|------------|-------------------------------------------------------------------|----------------------------|
| /pub/game/${gameCode}/chat/all          | 채팅       | {<br>sender: userSeq;<br>message: string;<br>}                     | 방 인원 모두에게 채팅 전송  |
| /pub/game/${gameCode}/chat/zara | 채팅 | {<br>sender: userSeq;<br>message: string;<br>} | 자라에게만 채팅 전송 |
| /pub/game/${gameCode}/chat/ghost         | 채팅       | {<br>sender: userSeq;<br>message: string;<br>}                     | 유령에게만 채팅 전송       |
| /pub/game/${gameCode}/vote | 투표 | {<br>userSeq: userSeq;<br>targetUserSeq: userSeq;<br>} | targetUserSeq: 0이면 투표 skip |
| /pub/game/${gameCode}/ability            | 능력 사용   | {<br>userSeq: userSeq;<br>targetUserSeq: userSeq;<br>}             |                            |
| /pub/game/${gameCode}/timer | 타이머 | {<br>userSeq: number,<br>decreaseTime: number<br>} | 타이머 종료시 서버에 알리기 |
| /pub/game/${gameCode}/timer/decrease     | 타이머 감소 | {<br>userSeq: number<br>}                                          |                            |
<<<<<<< HEAD
| /pub/game/${gameCode}/loc | 캐릭터 위치 | {<br>orderNumber: 1,<br>xAxis1: Double,<br>yAxis1: Double,<br>xAxis2: Double,<br>yAxis2: Double,<br>} | |
=======
| /pub/game/${gameCode}/loc | 캐릭터 위치 | {<br>orderNumber: 1,<br>xAxis1: Double,<br>yAxis1: Double,<br>xAxis2: Double,<br>yAxis2: Double,<br>} |

> > > > > > > b09f75098ef88a53adbf9ab279dead55003ba078
